(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,a){e.exports={incidentList:"IncidentList_incidentList__2eZkd",total:"IncidentList_total__iDXrF",incidentCard:"IncidentList_incidentCard__3WQcZ"}},19:function(e,t,a){e.exports={SearchPanel:"SearchPanel_SearchPanel__1foKe",errorMessage:"SearchPanel_errorMessage__3Etz9"}},20:function(e,t,a){e.exports={IncidentCard:"IncidentCard_IncidentCard__2-s2X",description:"IncidentCard_description__3uR4S",dateLocation:"IncidentCard_dateLocation__17kOc"}},22:function(e,t,a){e.exports={Case:"Case_Case__30Qdt",Map:"Case_Map__Fwe67"}},23:function(e,t,a){e.exports={Map:"Map_Map__2LgFX",text:"Map_text__2eo1a"}},35:function(e,t,a){e.exports={Main:"Main_Main__owx8l"}},37:function(e,t,a){e.exports={ErrorInfo:"ErrorInfo_ErrorInfo__14-cE"}},40:function(e,t,a){e.exports={Pagination:"Pagination_Pagination__e7rGA"}},41:function(e,t,a){e.exports={Header:"Header_Header__19fun"}},42:function(e,t,a){e.exports=a.p+"static/media/logo.37738632.png"},44:function(e,t,a){e.exports=a(80)},49:function(e,t,a){},80:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(17),o=a.n(c),i=(a(49),a(7)),s=a(11),l=a(12),u=a.n(l),d=a(15),p=a(1),m=a(2),h=a(4),f=a(3),g=a(5);function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.occurredBefore,a=e.occurredAfter,n=e.query,r=e.path,c=void 0===r?"incidents":r,o=e.incidentType,i=e.id,s="https://bikewise.org:443/api/v2/".concat(c),l=i?"".concat(s,"/").concat(i):"".concat(s,"?proximity=berlin&proximity_square=100").concat(t?"&occurred_before=".concat(t):"").concat(a?"&occurred_after=".concat(a):"").concat(n?"&query=".concat(n):"").concat(o?"&incident_type=".concat(o):"");return fetch(l,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){if(200!==e.status)throw console.log("ERROR response status incorrect",e.status),new Error("ERROR response status incorrect : ".concat(e.status));return e.json()}).catch(function(e){throw console.log("ERROR",e),new Error("ERROR: ".concat(e))})}var E=a(35),b=a.n(E),y=a(36),_=a(8),O=a.n(_),P=a(19),j=a.n(P),C=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={dateFrom:O()("2018-01-01").format("YYYY-MM-DD"),dateTo:O()().format("YYYY-MM-DD"),query:""},a.onChangeData=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.onSubmit=function(e){e.preventDefault();var t,n=a.props.onFind,r=a.state,c=r.dateFrom,o=r.dateTo,i=r.query;c&&!O()(c).isValid()&&(t="date From is not valid"),o&&!O()(o).isValid()&&(t="date To is not valid"),c&&o&&c>o&&(t='"From" date is greater than date "To"'),t?a.setState({errorMessage:t}):n({dateFrom:O()(c).unix(),dateTo:O()(o).unix(),query:i})},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.isDataLoading,t=this.state,a=t.dateFrom,n=t.dateTo,c=t.errorMessage;return r.a.createElement("div",{className:j.a.SearchPanel},r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("input",{type:"text",placeholder:"Search case descriptions",name:"query",maxLength:30,onChange:this.onChangeData}),r.a.createElement("div",null,r.a.createElement("div",null,"From"),r.a.createElement("input",{type:"date",placeholder:"from",name:"dateFrom",onChange:this.onChangeData,value:a})),r.a.createElement("div",null,r.a.createElement("div",null,"To"),r.a.createElement("input",{type:"date",placeholder:"to",name:"dateTo",onChange:this.onChangeData,value:n})),r.a.createElement("button",{type:"submit",disabled:e,onClick:this.onSubmit},"Find cases")),c&&r.a.createElement("div",{className:j.a.errorMessage},c))}}]),t}(n.PureComponent),w=a(37),x=a.n(w),k=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:x.a.ErrorInfo},r.a.createElement("p",null,"Ooops, something went wrong"))}}]),t}(n.PureComponent),D=a(18),M=a(20),L=a.n(M),S=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props,t=e.incident,a=e.incident,n=a.title,c=a.description,o=a.occurred_at,i=a.updated_at,s=a.media.image_url_thumb,l=a.address,u=a.id;return r.a.createElement("div",{className:L.a.IncidentCard},r.a.createElement("div",null,s&&r.a.createElement("img",{width:100,height:100,alt:"bike",src:s})),r.a.createElement("div",null,r.a.createElement(D.a,{to:{pathname:"case/".concat(u),state:{incident:t}}},r.a.createElement("div",null,n)),r.a.createElement("div",{className:L.a.description},c),r.a.createElement("div",null,r.a.createElement("strong",null,"Date of the theft:")," ".concat(O.a.unix(o).format("ddd MMM D YYYY"))),r.a.createElement("div",null,r.a.createElement("strong",null,"Report date:"),": ".concat(O.a.unix(i).format("ddd MMM D YYYY"))),r.a.createElement("div",null,r.a.createElement("strong",null,"Location:")," ".concat(l))))}}]),t}(n.PureComponent),F=a(40),I=a.n(F),N=10,T=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).openFirstPage=function(){(0,a.props.openPage)(1)},a.openPreviousPage=function(){var e=a.props,t=e.currentPage;(0,e.openPage)(t-1)},a.openNextPage=function(){var e=a.props,t=e.currentPage;(0,e.openPage)(t+1)},a.openLastPage=function(){(0,a.props.openPage)(a.getTotalPages)},a.getTotalPages=function(){var e=a.props.totalRecords;return Math.ceil(e/N)},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props,t=e.currentPage,a=e.openPage,n=new Array(this.getTotalPages()).fill(0).map(function(e,t){return t+1});return r.a.createElement("div",{className:I.a.Pagination},r.a.createElement("button",{type:"button",onClick:this.openFirstPage,disabled:1===t},"<< First"),r.a.createElement("button",{type:"button",onClick:this.openPreviousPage,disabled:1===t},"< Prev"),n.map(function(e){return r.a.createElement("button",{type:"button",onClick:function(){return a(e)},disabled:t===e,key:e},e)}),r.a.createElement("button",{type:"button",onClick:this.openNextPage,disabled:t===n.length},"Next >"),r.a.createElement("button",{type:"button",onClick:this.openLastPage,disabled:t===n.length},"Last >>"))}}]),t}(n.PureComponent),R=a(16),Y=a.n(R),A=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(c)))).listWithPagination=function(){var e=a.props,t=e.openPage,n=e.currentPage,c=e.incidents;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:Y.a.total},"total: ".concat(c.length)),c.filter(function(e,t){return N*(n-1)<=t&&t<N*n}).map(function(e){return r.a.createElement("div",{className:Y.a.incidentCard,key:e.id},r.a.createElement(S,{incident:e}))}),r.a.createElement(T,{currentPage:n,openPage:t,totalRecords:c.length}))},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.incidents;return r.a.createElement("div",{className:Y.a.incidentList},e.length>0?this.listWithPagination():r.a.createElement("p",null,"No results"))}}]),t}(n.PureComponent),q=a(41),B=a.n(q),W=a(42),X=a.n(W),H=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:B.a.Header},r.a.createElement("img",{src:X.a,alt:"logo"}),r.a.createElement("div",null,r.a.createElement("h1",null,"Police Department of Berlin"),r.a.createElement("h2",null,"Stolen bikes")))}}]),t}(n.PureComponent),K=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(c)))).state={isDataError:!1,isDataLoading:!1,incidents:[],currentPage:1},a.getData=Object(d.a)(u.a.mark(function e(){var t,n,r,c,o,i,s=arguments;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},n=t.dateFrom,r=t.dateTo,c=t.query,a.setState({isDataError:!1,isDataLoading:!0}),e.prev=2,e.next=5,v({dateFrom:n,dateTo:r,query:c});case 5:o=e.sent,i=o.incidents,a.setState({incidents:i}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),a.setState({isDataError:!0});case 13:return e.prev=13,a.setState({isDataLoading:!1}),e.finish(13);case 16:case"end":return e.stop()}},e,null,[[2,10,13,16]])})),a.onFind=function(e){var t=e.dateFrom,n=e.dateTo,r=e.query;a.setState({currentPage:1}),a.getData({dateFrom:t,dateTo:n,query:r})},a.openPage=function(e){a.setState({currentPage:e}),window.scrollTo(0,0)},a.dataLayout=function(){var e=a.state,t=e.isDataError,n=e.incidents,c=e.currentPage,o=e.isDataLoading;return t?r.a.createElement(k,null):o?r.a.createElement("p",null,"Loading ... "):r.a.createElement(A,{incidents:n,currentPage:c,openPage:a.openPage})},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.getData()}},{key:"render",value:function(){var e=this.state.isDataLoading;return r.a.createElement("div",{className:b.a.Main},r.a.createElement(H,null),r.a.createElement(C,{onFind:this.onFind,isDataLoading:e}),this.dataLayout())}}]),t}(n.PureComponent),Q=a(22),U=a.n(Q),Z=a(43),z=a.n(Z),G=a(23),J=a.n(G),V=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.center;return r.a.createElement("div",{className:J.a.Map},r.a.createElement(z.a,{bootstrapURLKeys:{key:"AIzaSyB23QiArAUU74ItBhbCBnc7gmBKXhdXumc"},defaultCenter:e,defaultZoom:15},r.a.createElement("div",{className:J.a.text},"* Incident location")))}}]),t}(n.Component),$=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={incident:{}},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=Object(d.a)(u.a.mark(function e(){var t,a,n,r,c,o,i,s;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,a=t.match.params.id,n=t.location.state,r=(n=void 0===n?{}:n).incident,!(c=r)){e.next=8;break}this.setState({incident:r}),e.next=19;break;case 8:return e.prev=8,e.next=11,v({id:a});case 11:o=e.sent,this.setState({incident:o.incident}),c=o.incident,e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(8),new Error("ERROR call api with caseId : ".concat(a));case 19:return e.next=21,v({path:"locations",occurredBefore:c.occurred_at+1,occurredAfter:c.occurred_at,incidentType:c.type.toLowerCase()});case 21:i=e.sent,(s=i.features.find(function(e){return e.properties.id===parseInt(a,10)}))&&this.setState({mapCoordinates:s.geometry.coordinates});case 24:case"end":return e.stop()}},e,this,[[8,16]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.incident,a=t.title,n=t.updated_at,c=t.description,o=t.address,i=e.mapCoordinates;return r.a.createElement("div",{className:U.a.Case},r.a.createElement(H,null),r.a.createElement("div",null,a),r.a.createElement("div",null,"Stolen ".concat(O.a.unix(n).format("llll")," at ").concat(o)),i&&r.a.createElement("div",{className:U.a.Map},r.a.createElement(V,{center:{lng:i[0],lat:i[1]}})),r.a.createElement("h2",null,"DESCRIPTION OF INCIDENT"),r.a.createElement("div",null,c))}}]),t}(n.PureComponent);$.defaultProps={location:{},match:{}};var ee=function(){return r.a.createElement(s.c,{history:Object(i.a)()},r.a.createElement(s.d,null,r.a.createElement(s.b,{exact:!0,path:"/",component:K}),r.a.createElement(s.b,{exact:!0,path:"/case/:id?",component:$}),r.a.createElement(s.a,{to:"/"})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(ee,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[44,1,2]]]);
//# sourceMappingURL=main.875e62be.chunk.js.map